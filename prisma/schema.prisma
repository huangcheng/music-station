// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Genre {
  id   Int    @id @default(autoincrement())
  name String @unique

  tracks TrackGenre[]
}

model Album {
  id         Int     @id @default(autoincrement())
  name       String  @unique
  year       Int?
  date       String?
  trackCount Int?
  artistId   Int?

  tracks Track[]
  artist Artist? @relation(fields: [artistId], references: [id])
}

model Artist {
  id   Int    @id @default(autoincrement())
  name String @unique

  tracks Track[]
  albums Album[]
}

model Track {
  id               Int      @id @default(autoincrement())
  hash             String   @unique
  name             String
  year             Int?
  artistId         Int?
  albumId          Int?
  trackNo          Int?
  disk             Int?
  cover            String?
  file             String
  date             String?
  codec            String?
  bitrate          Int?
  bitsPerSample    Int?
  sampleRate       Int?
  duration         Int?
  lossless         Boolean?
  numberOfChannels Int?
  size             Int?
  favorite         Boolean  @default(false)
  playCount        Int      @default(0)
  recentlyPlayed   Int?

  genre TrackGenre[]

  album     Album?          @relation(fields: [albumId], references: [id])
  artist    Artist?         @relation(fields: [artistId], references: [id])
  playlists PlaylistTrack[]
}

model TrackGenre {
  trackId Int
  genreId Int

  track Track @relation(fields: [trackId], references: [id])
  genre Genre @relation(fields: [genreId], references: [id])

  @@id([trackId, genreId])
}

model Playlist {
  id       Int     @id @default(autoincrement())
  name     String
  internal Boolean @default(false)

  tracks PlaylistTrack[]
}

model PlaylistTrack {
  playlistId Int
  trackId    Int

  playlist Playlist @relation(fields: [playlistId], references: [id])
  track    Track    @relation(fields: [trackId], references: [id])

  @@id([playlistId, trackId])
}
